package twolovers.exploitfixer.bukkit.adapters;

import com.comphenix.protocol.PacketType;
import com.comphenix.protocol.events.PacketAdapter;
import com.comphenix.protocol.events.PacketEvent;
import org.bukkit.GameMode;
import org.bukkit.entity.Player;
import org.bukkit.plugin.Plugin;
import twolovers.exploitfixer.interfaces.managers.ModuleManager;
import twolovers.exploitfixer.interfaces.modules.PacketsModule;
import twolovers.exploitfixer.shared.enums.Identity;

public class SetCreativeSlotPacketAdapter extends PacketAdapter {
	private final PacketsModule packetsModule;

	public SetCreativeSlotPacketAdapter(final Plugin plugin, final ModuleManager moduleManager) {
		super(plugin, PacketType.Play.Client.SET_CREATIVE_SLOT);
		this.packetsModule = moduleManager.getPacketsModule();
	}

	@Override
	public void onPacketReceiving(final PacketEvent event) {
		final Player player = event.getPlayer();

		if (player == null)
			packetsModule.checkPacket(event, Identity.SET_CREATIVE_SLOT_WRONG);
		else if (player.getGameMode() != GameMode.CREATIVE)
			packetsModule.checkPacket(event, Identity.SET_CREATIVE_SLOT_WRONG);
		else
			packetsModule.checkPacket(event, Identity.SET_CREATIVE_SLOT);
	}
}